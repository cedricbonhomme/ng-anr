<div class="md-padding-left md-padding-right" layout="column">
    <h3 layout="row" layout-align="start center"><md-button ng-click="resetOpSheet()"><md-icon>arrow_back</md-icon> {{ 'Back to the list' | translate }}</md-button></h3>

    <div layout="row">
        <table class="md-html-table" editable callback="changeRiskOp">
            <thead>
                <tr>
                    <th class="no-border"></th>
                    <th translate>Prob.</th>
                    <th>R</th>
                    <th>O</th>
                    <th>L</th>
                    <th>F</th>
                    <th>P</th>
                    <th translate>MAX risk</th>
                </tr>
            </thead>
            <tbody>
                <tr class="tbl-risk-calc">
                    <th class="txtright" translate>Current risk</th>
                    <td>{{ opsheet_risk.netProb }}</td>
                    <td>{{ opsheet_risk.netR }}</td>
                    <td>{{ opsheet_risk.netO }}</td>
                    <td>{{ opsheet_risk.netL }}</td>
                    <td>{{ opsheet_risk.netF }}</td>
                    <td>{{ opsheet_risk.netP }}</td>
                    <td class="tbl-risk-calc" ng-class="{'green': opsheet_risk.cacheNetRisk >= 0 && opsheet_risk.cacheNetRisk < thresholds.rolf_thresholds.min, 'orange': opsheet_risk.cacheNetRisk >= thresholds.rolf_thresholds.min && opsheet_risk.cacheNetRisk < thresholds.rolf_thresholds.max, 'red': opsheet_risk.cacheNetRisk >= thresholds.rolf_thresholds.max}">{{ opsheet_risk.cacheNetRisk }}</td>
                </tr>
                <tr class="tbl-risk-calc" edit-model="opsheet_risk">
                    <th class="txtright" translate>Target risk</th>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedProb"></td>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedR"></td>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedO"></td>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedL"></td>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedF"></td>
                    <td class="small" edit-readonly="isAnrReadOnly" edit-field="targetedP"></td>
                    <td class="tbl-risk-calc" ng-class="{'green': opsheet_risk.cacheTargetedRisk >= 0 && opsheet_risk.cacheTargetedRisk < thresholds.rolf_thresholds.min, 'orange': opsheet_risk.cacheTargetedRisk >= thresholds.rolf_thresholds.min && opsheet_risk.cacheTargetedRisk < thresholds.rolf_thresholds.max, 'red': opsheet_risk.cacheTargetedRisk >= thresholds.rolf_thresholds.max}">{{ opsheet_risk.cacheTargetedRisk }}</td>
                </tr>
                <tr>
                    <th class="txtright w120p" translate>Instance</td>
                    <td class="bold" colspan="7"><md-icon ng-if="opsheet_risk.instanceInfos.scope == 2" class="md-tree-global-icon">language</md-icon>{{ opsheet_risk.instanceInfos[_langField("name")] }}</td>
                </tr>
                <tr>
                    <th class="txtright w120p" translate>Risk description</td>
                    <td colspan="7">{{ opsheet_risk[_langField("label")] }}</td>
                </tr>
                <tr>
                    <th class="txtright w120p" translate>Risk probability</td>
                    <td colspan="7">
                        <p ng-if="opsheet_risk.netProb == -1">-</p>
                        <p ng-if="opsheet_risk.netProb > -1"><strong>{{ opsheet_risk.netProb }}</strong> - {{ comms.threat[opsheet_risk.netProb][_langField('comment')] }}</p>
                    </td>
                </tr>
                <tr>
                    <th class="txtright w120p" translate>Measures set</td>
                    <td colspan="7">
                        {{opsheet_risk.comment}}
                    </td>
                </tr>
                <tr ng-if="OFFICE_MODE == 'FO'">
                    <th class="txtright w120p" translate>Recommendations</th>
                    <td colspan="7">
                        <ul class="no-list-style no-padding">
                            <li ng-repeat="rec in _copyRecs">{{ rec.recommandation.code }} <span class="anr-importance" ng-repeat="i in range(1, rec.recommandation.importance)">&bull;</span> &gt; {{ rec.recommandation.description }}</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <th class="txtright w120p" translate>Processing type</td>
                    <td colspan="7">
                        <md-input-container class="md-block" style="width: 200px">
                            <md-icon>widgets</md-icon>
                            <md-select ng-model="opsheet_risk.kindOfMeasure" ng-disabled="isAnrReadOnly">
                                <md-option ng-value="5">{{ 'Not processed' | translate }}</md-option>
                                <md-option ng-value="1">{{ 'Reduction' | translate }}</md-option>
                                <md-option ng-value="2">{{ 'Denied' | translate }}</md-option>
                                <md-option ng-value="3">{{ 'Accepted' | translate }}</md-option>
                                <md-option ng-value="4">{{ 'Shared' | translate }}</md-option>
                            </md-select>
                        </md-input-container>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div layout="row" layout-align="end center">
        <md-button class="md-raised" ng-disabled="isAnrReadOnly" ng-click="saveOpRiskSheet(opsheet_risk)">{{ 'Save' | translate }}</md-button>
    </div>

    <ng-include ng-if="OFFICE_MODE == 'FO'" monarc-mode="operational" ng-controller="RiskRecommendationPartialCtrl" src="'/views/anr/_risk_rec_create_form.html'"></ng-include>
    <ng-include ng-if="OFFICE_MODE == 'FO'" monarc-mode="operational" ng-controller="RiskRecommendationPartialCtrl" src="'/views/anr/_risk_rec_form.html'"></ng-include>

</div>
