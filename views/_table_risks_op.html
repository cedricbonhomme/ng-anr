<md-tab label="{{ 'OP risks table' | translate }}">
    <p class="md-title md-padding" translate>{{ oprisks.length || 0 }} operational risk(s)</p>

    <div ng-include="'views/anr/_oprisk_sheet.html'" ng-if="opsheet_risk"></div>

    <div ng-if="!oprisks || !oprisks.length" class="md-padding">
        <em ng-if="instmode == 'inst' ">{{ 'There are no operational risks for this instance, so the operational risks table is empty.' | translate }}</em>
        <em ng-if="instmode == 'anr' ">{{ 'There are no operational risks for this risk analysis.' | translate }}</em>
        <em ng-if="instmode == 'obj' ">{{ 'There are no operational risks for this object.' | translate }}</em>
    </div>
    <table class="md-html-table inputs-as-number" ng-if="!opsheet_risk && oprisks.length > 0" editable callback="changeRiskOp">
        <thead>
        <tr>
            <th rowspan="3" translate>Risk description</th>
            <th ng-if="model.showRolfBrut" colspan="7" translate>RAW</th>
            <th colspan="7" translate>NET</th>
            <th rowspan="3" translate>Observation</th>
            <th rowspan="3">T</th>
            <th rowspan="3" translate>Target risk</th>
            <th ng-if=" instmode != 'obj' " rowspan="3" translate>Actions</th>
        </tr>

        <tr>
            <th rowspan="2" translate ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">Prob.</th>
            <th colspan="5" translate ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">Impact</th>
            <th rowspan="2" translate ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">Calculated risk</th>

            <th rowspan="2" translate>Prob.</th>
            <th colspan="5" translate>Impact</th>
            <th rowspan="2" translate>Calculated risk</th>
        </tr>

        <tr>
            <th ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">R</th>
            <th ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">O</th>
            <th ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">L</th>
            <th ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">F</th>
            <th ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr') ">P</th>

            <th>R</th>
            <th>O</th>
            <th>L</th>
            <th>F</th>
            <th>P</th>
        </tr>
        </thead>

        <tbody>
        <tr ng-repeat="risk in oprisks" edit-model="risk">
            <td class="preserve-newlines">{{ risk[_langField('description')] }}</td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutProb" title="{{threatCommCache[risk.brutProb]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutR" title="{{scaleCommCache[4][risk.brutR]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutO" title="{{scaleCommCache[5][risk.brutO]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutL" title="{{scaleCommCache[6][risk.brutL]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutF" title="{{scaleCommCache[7][risk.brutF]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" edit-filter="dashnull" edit-field="brutP" title="{{scaleCommCache[8][risk.brutP]}}"></td>
            <td ng-if="model.showRolfBrut && (instmode != 'obj' || mode == 'anr')" class="tbl-risk-calc"
                ng-class="{'green': risk.cacheBrutRisk > 0 && risk.cacheBrutRisk < thresholds.rolf_thresholds.min, 'orange': risk.cacheBrutRisk >= thresholds.rolf_thresholds.min && risk.cacheBrutRisk < thresholds.rolf_thresholds.max, 'red': risk.cacheBrutRisk >= thresholds.rolf_thresholds.max}">{{risk.cacheBrutRisk|dashnull}}</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netProb" edit-filter="dashnull" title="threatCommCache[risk.netProb]"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netR" edit-filter="dashnull" title="{{scaleCommCache[4][risk.netR]}}"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netO" edit-filter="dashnull" title="{{scaleCommCache[5][risk.netO]}}"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netL" edit-filter="dashnull" title="{{scaleCommCache[6][risk.netL]}}"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netF" edit-filter="dashnull" title="{{scaleCommCache[7][risk.netF]}}"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="small" ng-if="instmode == 'anr'" edit-field="netP" edit-filter="dashnull" title="{{scaleCommCache[8][risk.netP]}}"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="tbl-risk-calc" ng-class="{'green': risk.cacheNetRisk > 0 && risk.cacheNetRisk < thresholds.rolf_thresholds.min, 'orange': risk.cacheNetRisk >= thresholds.rolf_thresholds.min && risk.cacheNetRisk < thresholds.rolf_thresholds.max, 'red': risk.cacheNetRisk >= thresholds.rolf_thresholds.max}">{{ risk.cacheNetRisk|dashnull }}</td>
            <td class="preserve-newlines" ng-if="instmode == 'anr'" edit-field="comment" edit-type="textarea"></td>
            <td class="small" ng-if="instmode == 'obj'">-</td>
            <td class="txtcenter"><div style="display:inline-block" class="green-dot" ng-if="risk.t"></div></td>
            <td class="tbl-risk-calc" ng-class="{'green': risk.cacheTargetedRisk > 0 && risk.cacheTargetedRisk < thresholds.rolf_thresholds.min, 'orange': risk.cacheTargetedRisk >= thresholds.rolf_thresholds.min && risk.cacheTargetedRisk < thresholds.rolf_thresholds.max, 'red': risk.cacheTargetedRisk >= thresholds.rolf_thresholds.max}">{{ risk.cacheTargetedRisk|dashnull }}</td>
            <td class="txtcenter" ng-if=" instmode != 'obj' ">
                <a href="javascript:;" ng-click="openOpRiskSheet(risk)" title="{{ 'Open risk sheet' | translate }} - {{instmode}}">
                    <md-icon>open_in_new</md-icon>
                </a>
            </td>
        </tr>
        </tbody>
    </table>
</md-tab>
